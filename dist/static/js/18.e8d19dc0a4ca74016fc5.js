webpackJsonp([18],{RPjS:function(e,t){},p67t:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("woOf"),n=s.n(i),o=s("Dd8w"),a=s.n(o),r=s("NYxO"),l={data:function(){return{filterVisible:!1,sortVisible:!1,filterIndex:-1,sortIndex:-1,filterSelectedIndex:-1,sortSelectedIndex:-1,filters:[],sorts:["价格从高到低","价格从低到高"],goodsList:[],pageInfo:{},loading:!1,category:""}},created:function(){this.category=this.$route.params,this.fetchSeries()},computed:a()({},Object(r.c)(["getCommon"])),methods:a()({},Object(r.d)(["setCommon"]),Object(r.b)(["ajax"]),{openFilter:function(){this.filterVisible=!0,this.filterIndex=this.filterSelectedIndex},openSort:function(){this.sortVisible=!0,this.sortIndex=this.sortSelectedIndex},handleFilterConfirm:function(){this.pageInfo.currentPage=0,this.filterSelectedIndex=this.filterIndex,this.setCommon({goodsType:this.filters[this.filterIndex].series_id}),this.fetchGoods()},handleSortConfirm:function(){this.pageInfo.currentPage=0,this.sortSelectedIndex=this.sortIndex,this.fetchGoods()},fetchGoods:function(){var e=this,t={series:this.getCommon.goodsType,page:(this.pageInfo.currentPage||0)+1};-1!==this.sortSelectedIndex&&n()(t,{orderby:Math.abs(this.sortSelectedIndex-1)}),this.category&&n()(t,this.category),this.ajax({name:"goods",data:t}).then(function(t){e.pageInfo={currentPage:t.page,totalPage:t.pages},1==e.pageInfo.currentPage&&(e.goodsList=[]),e.goodsList=e.goodsList.concat(t.list),e.pageInfo.currentPage<e.pageInfo.totalPage?e.loading=!1:1!=e.pageInfo.currentPage&&e.toast("没有更多数据了")})},fetchSeries:function(){var e=this;this.ajax({name:"series"}).then(function(t){e.filters=t,e.filterIndex=t.findIndex(function(t){return t.series_id===e.getCommon.goodsType}),e.filterSelectedIndex=e.filterIndex,e.fetchGoods()})},loadMore:function(){this.loading=!0,this.fetchGoods()},goDetail:function(e){this.setCommon({goodsId:e.goods_id}),this.$router.push({name:"goodsdetail"})}})},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"pt"},[i("v-header-menus",{attrs:{home:""}},[i("input",{attrs:{type:"text",placeholder:"请选择您要搜索的作品类型",readonly:""},on:{click:function(t){e.$router.push({name:"goodssearch"})}}}),e._v(" "),i("div",{staticClass:"menus",attrs:{slot:"menus"},slot:"menus"},[i("div",{staticClass:"menu",on:{click:function(t){e.$router.push({name:"goodssearch"})}}},[i("img",{attrs:{src:s("wHS4"),alt:""}})])])]),e._v(" "),i("div",{staticClass:"condition"},[i("ul",{staticClass:"flex"},[i("li",{staticClass:"flex",on:{click:e.openFilter}},[i("span",[e._v("筛选")]),e._v(" "),i("div",{staticClass:"arrow-down",class:{active:e.filterVisible}})]),e._v(" "),i("li",{staticClass:"flex",on:{click:e.openSort}},[i("span",[e._v("排序")]),e._v(" "),i("div",{staticClass:"arrow-down",class:{active:e.sortVisible}})])])]),e._v(" "),i("div",{staticClass:"content"},[i("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:e.loadMore,expression:"loadMore"}],staticClass:"list",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"50","infinite-scroll-immediate-check":"true"}},e._l(e.goodsList,function(t,s){return i("li",{key:s,staticClass:"flex",on:{click:function(s){e.goDetail(t)}}},[i("div",{staticClass:"img"},[i("img",{attrs:{src:t.img,alt:""}})]),e._v(" "),i("div",{staticClass:"detail flex-auto flex"},[i("span",{staticClass:"name"},[e._v(e._s(t.goods_title))]),e._v(" "),i("span",{staticClass:"desc"},[e._v(e._s(t.sub_title))]),e._v(" "),i("div",{staticClass:"line3 flex"},[i("div",{staticClass:"price"},[i("span",[e._v("￥")]),e._v(e._s(e._f("currency")(t.price)))]),e._v(" "),i("div",{staticClass:"cart"})])])])})),e._v(" "),e.pageInfo.currentPage<e.pageInfo.totalPage?i("p",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loading"},[i("mt-spinner",{attrs:{type:"fading-circle"}}),e._v(" "),i("span",[e._v("加载中...")])],1):e._e()]),e._v(" "),i("v-popup-confirm",{attrs:{title:"筛选",isConfirm:-1!==e.filterIndex},on:{confirm:e.handleFilterConfirm},model:{value:e.filterVisible,callback:function(t){e.filterVisible=t},expression:"filterVisible"}},[i("v-input-radio",{attrs:{list:e.filters.map(function(e){return e.name})},model:{value:e.filterIndex,callback:function(t){e.filterIndex=t},expression:"filterIndex"}})],1),e._v(" "),i("v-popup-confirm",{attrs:{title:"排序",isConfirm:-1!==e.sortIndex},on:{confirm:e.handleSortConfirm},model:{value:e.sortVisible,callback:function(t){e.sortVisible=t},expression:"sortVisible"}},[i("v-input-radio",{attrs:{list:e.sorts},model:{value:e.sortIndex,callback:function(t){e.sortIndex=t},expression:"sortIndex"}})],1)],1)},staticRenderFns:[]};var d=s("VU/8")(l,c,!1,function(e){s("RPjS")},"data-v-788eb5bc",null);t.default=d.exports}});
//# sourceMappingURL=18.e8d19dc0a4ca74016fc5.js.map